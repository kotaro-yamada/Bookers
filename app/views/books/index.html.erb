
  
<%= render 'users/list', user: @user, book:@book %>

<div class="Books col-xs-9">
  
  <%# 検索フォーム%>
  <% if user_signed_in? %>
    <%= form_tag(search_path, method: :get) do%>
      <%= text_field_tag (:word) %>
      <%= select_tag 'range', options_for_select([['User', '1'], ['Book', '2']]) %>
      <%= select_tag 'search', options_for_select([["完全一致", "perfect_match"], ["前方一致", "forward_match"], ["後方一致", "backward_match"], ["部分一致", "partial_match"]])%>
      <%= submit_tag "検索" %>
    <% end %>
  <% end %>

  <h2>Books</h2>
  <table class="table-hover table table-sm">
    <tr>
      <th></th>
      <th>Title</th>
      <th>Opinion</th>
      <th>いいね</th>
      <th>コメント数</th>
    </tr>
    <% @books.each do |book| %>
        <tr>
          <td>
            <%= link_to user_path(book.user.id) do %>
              <%= attachment_image_tag book.user, :profile_image, :fill, 60, 60, format: 'jpeg', class: "img-circle pull-left profile-img", fallback: "no_image.jpg" %>
            <% end %>
          </td>
          <td><%= link_to"#{book.title}", book_path(book.id) %></td>
          <td><%= book.body %></td>

          <% if book.favorited_by?(current_user) %>
          <td><%= link_to book_favorites_path(book),method: :delete do %>
              <span class="glyphicon glyphicon-heart" aria-hidden="true"></span>
              <%= book.favorites.count %>
              <% end %>
          </td>
          <% else %>
          <td><%= link_to book_favorites_path(book),method: :post do %>
              <i class="glyphicon glyphicon-heart-empty"></i>
              <%= book.favorites.count %>
              <% end %>           
          </td>
          <% end %>

          <td><p>コメント数：</p><%= book.post_comments.count %></td>
        </tr>
      <% end %>
  </table>
</div>


</div>
</div>
